# ============================================================================
# Casino Royal SaaS Platform - Environment Variables
# ============================================================================
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to `.env` for local development: cp .env.example .env
# 2. Replace all placeholder values with actual secrets
# 3. For Render.com: Add these in Dashboard > Environment > Environment Variables
# 4. NEVER commit the actual `.env` file to version control (already in .gitignore)
#
# RENDER.COM QUICK START:
# - DATABASE_URL: Auto-provided by Render PostgreSQL (don't set manually)
# - SECRET_KEY: Use "Generate Value" button in Render Dashboard
# - PORT: Auto-set by Render to 10000 (don't override)
# - All others: Add manually in Render Dashboard
#
# ============================================================================

# ============================================================================
# APPLICATION URL (REQUIRED FOR EMAIL VERIFICATION)
# ============================================================================

# Base URL of your application (used for email verification links)
# LOCAL DEVELOPMENT:
BASE_URL=http://127.0.0.1:8000
#
# PRODUCTION (Render.com):
# BASE_URL=https://your-app-name.onrender.com

# ============================================================================
# DATABASE (REQUIRED)
# ============================================================================

# Database connection string
#
# LOCAL DEVELOPMENT (SQLite):
DATABASE_URL=sqlite:///./casino.db
#
# LOCAL DEVELOPMENT (PostgreSQL):
# DATABASE_URL=postgresql://username:password@localhost:5432/casino_db
#
# RENDER DEPLOYMENT:
# - Automatically provided when you link PostgreSQL service in Render Dashboard
# - Format: postgresql://user:pass@hostname.region.render.com/dbname
# - Do NOT set this manually in Render; it's auto-generated and auto-injected
# - Render handles connection pooling and SSL automatically
#
# IMPORTANT: Render's DATABASE_URL may use postgres:// instead of postgresql://
# The app automatically fixes this (see app/database.py:11-12)

# ============================================================================
# JWT AUTHENTICATION (REQUIRED)
# ============================================================================

# Secret key for JWT token signing - CRITICAL SECURITY SETTING
#
# GENERATE WITH: openssl rand -hex 32
#
# LOCAL: Use any secure random string for development
SECRET_KEY=your-super-secret-key-change-this-in-production-openssl-rand-hex-32
#
# RENDER: Use "Generate Value" button in Dashboard for cryptographically secure key
# - Go to: Dashboard > Service > Environment
# - Click "Add Environment Variable"
# - Key: SECRET_KEY
# - Click "Generate Value" (generates secure 32-byte random string)
# - Toggle "Secret" ON to hide value in UI
#
# SECURITY WARNING: Changing this key invalidates all existing user sessions!

# JWT signing algorithm (standard, no need to change)
ALGORITHM=HS256

# JWT token expiration time in minutes
# Default: 30 minutes (recommended for security)
# Longer = more convenient but less secure
# Shorter = more secure but requires frequent re-login
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ============================================================================
# CORS (Cross-Origin Resource Sharing) - SECURITY CRITICAL
# ============================================================================

# Comma-separated list of allowed frontend origins
#
# DEVELOPMENT: Use "*" to allow all origins (convenient but insecure)
CORS_ORIGINS=*
#
# PRODUCTION: MUST specify exact domains (app will not start without this)
# Examples:
#   Single domain: CORS_ORIGINS=https://your-frontend.com
#   Multiple domains: CORS_ORIGINS=https://app.com,https://admin.app.com
#
# RENDER PRODUCTION EXAMPLE:
# CORS_ORIGINS=https://your-frontend.onrender.com,https://your-custom-domain.com
#
# IMPORTANT:
#   - Include protocol (https://)
#   - No trailing slashes
#   - No spaces between domains
#   - NEVER use "*" in production (major security vulnerability!)
#
# If CORS_ORIGINS not set in production, app uses ENVIRONMENT-based defaults:
#   - development: http://localhost:3000,http://localhost:8000,http://localhost:5173
#   - production: ERROR - must be explicitly set (app will crash on startup)

# ============================================================================
# ENVIRONMENT CONFIGURATION (REQUIRED)
# ============================================================================

# Application environment setting
# Options: development, staging, production
#
# LOCAL: development
ENVIRONMENT=development
#
# RENDER: production
# ENVIRONMENT=production
#
# This affects:
#   - CORS behavior (strict in production)
#   - Logging verbosity
#   - Error messages (detailed in dev, generic in prod)
#   - Security headers (strict in production)
#   - API documentation (disabled in production for security)
#   - Rate limiting defaults

# ============================================================================
# AWS S3 FILE STORAGE (HIGHLY RECOMMENDED FOR RENDER)
# ============================================================================

# AWS S3 is ESSENTIAL for Render deployment due to ephemeral filesystem
# Without S3: All uploaded files (avatars, images, documents) are deleted on restart
#
# SETUP GUIDE: See AWS_S3_SETUP_GUIDE.md in project root
#
# AWS FREE TIER:
#   - 5 GB storage
#   - 20,000 GET requests per month
#   - 2,000 PUT requests per month
#   - 12 months free for new accounts
#
# IAM SETUP:
#   1. Go to AWS Console > IAM > Users > Create User
#   2. Attach policy: AmazonS3FullAccess (or create custom policy)
#   3. Create Access Key > Copy Access Key ID and Secret Access Key
#   4. Create S3 bucket in same region as Render (us-east-1 recommended)

# AWS Access Key ID (from IAM user credentials)
AWS_ACCESS_KEY_ID=your-aws-access-key-here

# AWS Secret Access Key (from IAM user credentials)
# KEEP SECRET: Never commit to git or share publicly
AWS_SECRET_ACCESS_KEY=your-aws-secret-key-here

# S3 Bucket name (must be globally unique across all AWS accounts)
# Naming rules: lowercase, no spaces, hyphens OK, 3-63 characters
# Example: casino-royal-uploads-prod
AWS_S3_BUCKET_NAME=your-bucket-name-here

# AWS Region (choose closest to your Render service)
# Render US-East: us-east-1 (recommended - lowest latency)
# Render US-West: us-west-2
# Render EU: eu-west-1
AWS_REGION=us-east-1
#
# If S3 is not configured, app falls back to local filesystem storage
# WARNING: Local storage on Render is ephemeral (files lost on restart/deployment)

# ============================================================================
# CREDENTIAL ENCRYPTION (REQUIRED FOR GAME CREDENTIALS FEATURE)
# ============================================================================

# Fernet encryption key for encrypting game account credentials
#
# GENERATE WITH:
#   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#
# EXAMPLE OUTPUT: gAAAAABhX1234567890abcdefGHIJKLMNOPQRSTUVWXYZ=
#
CREDENTIAL_ENCRYPTION_KEY=your-44-character-fernet-key-here
#
# RENDER SETUP:
#   1. Generate key locally with command above
#   2. Add to Render Dashboard as Environment Variable
#   3. Toggle "Secret" ON to hide from UI
#
# CRITICAL WARNING:
#   - If you lose this key, all encrypted game credentials become unrecoverable
#   - Do NOT change this key in production (makes existing credentials unreadable)
#   - Backup this key securely (password manager, secure vault)
#   - Use different keys for dev/staging/production

# ============================================================================
# EMAIL SERVICE (REQUIRED FOR PRODUCTION)
# ============================================================================

# Email service for user verification, password resets, notifications
# Currently configured for SendGrid (free tier: 100 emails/day)
#
# SENDGRID SETUP:
#   1. Create account: https://signup.sendgrid.com (free tier available)
#   2. Verify account and sender email
#   3. Create API Key: Settings > API Keys > Create API Key
#   4. Copy API key and add below
#   5. Verify sender: Settings > Sender Authentication > Verify Single Sender
#
# ALTERNATIVES:
#   - AWS SES (cheaper at scale, more setup)
#   - Mailgun (simple, reliable)
#   - Postmark (excellent deliverability)

# SMTP server hostname
# SendGrid: smtp.sendgrid.net
# AWS SES: email-smtp.us-east-1.amazonaws.com
SMTP_HOST=smtp.sendgrid.net

# SMTP server port
# 587: TLS/STARTTLS (recommended, most compatible)
# 465: SSL (legacy, still works)
# 25: Plain (insecure, often blocked)
SMTP_PORT=587

# SMTP username
# SendGrid: Always "apikey" (literal string, not your actual key)
# AWS SES: Your SMTP username from SES console
SMTP_USERNAME=apikey

# SMTP password
# SendGrid: Your SendGrid API Key (starts with SG.)
# AWS SES: Your SMTP password from SES console
SMTP_PASSWORD=your-sendgrid-api-key-here

# From email address (must be verified sender in email service)
# IMPORTANT: Must match verified sender domain/email in SendGrid
# Example: noreply@yourdomain.com
SMTP_FROM_EMAIL=noreply@yourdomain.com

# From name (displayed in email client)
SMTP_FROM_NAME=Casino Royal

# ============================================================================
# PAYMENT PROCESSING (REQUIRED FOR REVENUE)
# ============================================================================

# Stripe payment gateway integration
# Get keys from: https://dashboard.stripe.com/apikeys
#
# STRIPE SETUP:
#   1. Create Stripe account: https://dashboard.stripe.com/register
#   2. Complete business verification (required for live payments)
#   3. Get API keys: Dashboard > Developers > API Keys
#   4. Setup webhook: Dashboard > Developers > Webhooks > Add Endpoint
#
# TEST vs LIVE KEYS:
#   - Development: Use TEST keys (sk_test_..., pk_test_...)
#   - Production: Use LIVE keys (sk_live_..., pk_live_...)
#   - NEVER mix test and live keys in same environment

# Stripe Secret API Key (server-side only, KEEP SECRET)
# Development: sk_test_...
# Production: sk_live_...
STRIPE_API_KEY=sk_test_your_stripe_secret_key_here

# Stripe Publishable Key (safe for frontend/client-side)
# Development: pk_test_...
# Production: pk_live_...
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here

# Stripe Webhook Secret (for webhook signature verification)
#
# WEBHOOK SETUP (CRITICAL FOR SECURITY):
#   1. Stripe Dashboard > Developers > Webhooks > Add Endpoint
#   2. Endpoint URL: https://your-app.onrender.com/payments/webhook
#   3. Events to send:
#      - payment_intent.succeeded
#      - payment_intent.payment_failed
#      - customer.created
#      - customer.updated
#   4. Copy "Signing secret" (starts with whsec_)
#
# This secret verifies webhooks are actually from Stripe (prevents fraud)
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_signing_secret_here

# ============================================================================
# FEATURE FLAGS (OPTIONAL)
# ============================================================================

# Enable rate limiting to prevent abuse
# Options: True, False (case-insensitive)
#
# LOCAL: False (easier for development/testing)
ENABLE_RATE_LIMITING=False
#
# RENDER: True (HIGHLY RECOMMENDED for production)
# ENABLE_RATE_LIMITING=True
#
# Rate limits (when enabled):
#   - Login: 5 attempts per minute
#   - Registration: 3 per hour
#   - API calls: 1000 per hour per IP
#   - See app/rate_limit.py for full configuration

# ============================================================================
# LOGGING (OPTIONAL)
# ============================================================================

# Logging verbosity level
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
#
# LOCAL: DEBUG (shows all details, helpful for development)
# LOG_LEVEL=DEBUG
#
# RENDER: INFO (balanced, recommended for production)
LOG_LEVEL=INFO
#
# PRODUCTION: WARNING or ERROR (only important issues, less noise)
# LOG_LEVEL=WARNING
#
# Log levels explained:
#   - DEBUG: Everything (very verbose, use in development only)
#   - INFO: General information, startup messages, requests
#   - WARNING: Unusual events that might need attention
#   - ERROR: Errors that need investigation
#   - CRITICAL: Severe errors causing system instability

# ============================================================================
# REDIS CACHING (OPTIONAL - FOR PERFORMANCE AT SCALE)
# ============================================================================

# Redis connection URL for caching and session management
#
# BENEFITS:
#   - 50-70% reduction in database queries
#   - Faster API response times
#   - Distributed rate limiting (scales across multiple Render instances)
#   - Session storage (scales horizontally)
#
# RENDER REDIS SETUP:
#   1. Dashboard > New > Redis
#   2. Name: casino-royal-redis
#   3. Plan: Starter ($10/month, 512MB)
#   4. Link to your web service
#   5. Render auto-injects REDIS_URL environment variable
#
# Format: redis://default:password@hostname:6379
# RENDER: Auto-provided when Redis service is linked
# REDIS_URL=redis://default:password@hostname:6379
#
# If not configured, app works without Redis (no caching, local rate limiting only)

# ============================================================================
# MONITORING & ERROR TRACKING (RECOMMENDED FOR PRODUCTION)
# ============================================================================

# Sentry error tracking and performance monitoring
# Free tier: 5,000 events/month, 10,000 performance units/month
#
# SENTRY SETUP:
#   1. Create account: https://sentry.io/signup
#   2. Create new project: Select "Python/FastAPI"
#   3. Copy DSN from Project Settings > Client Keys (DSN)
#   4. Add DSN below for automatic error reporting
#
# BENEFITS:
#   - Real-time error notifications
#   - Stack traces with code context
#   - Performance monitoring (slow endpoints, database queries)
#   - User impact analysis
#   - Release tracking
#
# SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# RENDER-SPECIFIC NOTES
# ============================================================================
#
# RENDER AUTO-PROVIDED VARIABLES (do NOT set these manually):
#   - DATABASE_URL: Auto-injected when PostgreSQL service is linked
#   - PORT: Auto-set to 10000 (used in start command)
#   - RENDER: Set to "true" (indicates Render environment)
#   - RENDER_SERVICE_NAME: Your service name
#   - RENDER_EXTERNAL_URL: Your public URL (https://app-name.onrender.com)
#   - REDIS_URL: Auto-injected when Redis service is linked
#
# RENDER DASHBOARD CONFIGURATION:
#   1. Go to: Dashboard > Your Service > Environment
#   2. Click "Add Environment Variable" for each variable above
#   3. Use "Secret" toggle for sensitive values (API keys, passwords)
#   4. Use "Generate Value" for SECRET_KEY (auto-generates secure random)
#   5. Click "Save Changes" (triggers redeploy)
#
# BUILD & START COMMANDS (already in render.yaml):
#   Build: pip install -r requirements.txt && alembic upgrade head
#   Start: uvicorn app.main:app --host 0.0.0.0 --port $PORT
#
# DEPLOYMENT CHECKLIST FOR RENDER:
#   ✅ DATABASE_URL: Linked PostgreSQL service
#   ✅ SECRET_KEY: Generated secure value (not default)
#   ✅ ENVIRONMENT: Set to "production"
#   ✅ CORS_ORIGINS: Set to actual frontend domain(s)
#   ✅ CREDENTIAL_ENCRYPTION_KEY: Generated Fernet key
#   ✅ AWS S3: Configured (for persistent file storage)
#   ✅ Email (SMTP): SendGrid configured (for email verification)
#   ✅ Stripe: API keys configured (for payment processing)
#   ✅ ENABLE_RATE_LIMITING: Set to True (prevent abuse)
#   ✅ LOG_LEVEL: Set to INFO or WARNING (reduce noise)
#
# SECURITY BEST PRACTICES FOR RENDER:
#   1. Use "Secret" toggle for all sensitive variables
#   2. Never commit .env file to git (already in .gitignore)
#   3. Rotate SECRET_KEY and API keys periodically (quarterly)
#   4. Never use development/test keys in production
#   5. Set CORS_ORIGINS to specific domains (never "*")
#   6. Enable HTTPS only (Render provides free SSL certificates)
#   7. Monitor Sentry for security-related errors
#   8. Use different encryption keys for dev/staging/production
#
# TROUBLESHOOTING COMMON RENDER ISSUES:
#   - App won't start: Check required variables (DATABASE_URL, SECRET_KEY)
#   - CORS errors: Verify CORS_ORIGINS exactly matches frontend domain
#   - Email not working: Verify SMTP credentials, check sender verification
#   - File uploads lost: Configure AWS S3 (Render filesystem is ephemeral)
#   - Database errors: Check DATABASE_URL format, verify PostgreSQL service linked
#   - Build failures: Check requirements.txt, verify Python version in render.yaml
#   - Migration errors: Check alembic/versions/ for duplicate/conflicting migrations
#
# RENDER FREE TIER LIMITS:
#   - Web Service: 750 hours/month (enough for 1 service running 24/7)
#   - PostgreSQL: 90-day trial, then $7/month for starter plan
#   - Restarts: Service sleeps after 15min inactivity (free tier only)
#   - Cold starts: ~30 seconds wake-up time after sleep (free tier only)
#
# UPGRADE TO PAID TIER FOR PRODUCTION:
#   - No sleep/cold starts
#   - Better performance (more CPU/RAM)
#   - Custom domains
#   - Priority support
#   - Starting at $7/month (Starter plan)
#
# SUPPORT RESOURCES:
#   - Render Docs: https://render.com/docs
#   - Project Docs: README.md, RENDER_DEPLOYMENT_GUIDE.md
#   - AWS S3 Setup: AWS_S3_SETUP_GUIDE.md
#   - GitHub Issues: Report bugs or request features
#
# ============================================================================
# END OF CONFIGURATION
# ============================================================================
